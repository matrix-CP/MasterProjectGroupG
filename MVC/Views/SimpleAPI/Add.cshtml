@model MVC.Models.tblEmployee

<h2>Add Employee</h2>

<div>
    <form id="AddEmployeeForm" enctype="multipart/form-data">
        <div class="form-group">
            <label for="c_empname">Employee Name:</label>
            <input type="text" class="form-control" id="empname" name="empname">
        </div>
        <div class="form-group">
            <label>Gender:</label>
            <div class="form-check">
                <input type="radio" class="form-check-input" id="male" name="empgender" value="Male">
                <label class="form-check-label" for="male">Male</label>
            </div>
            <div class="form-check">
                <input type="radio" class="form-check-input" id="female" name="empgender" value="Female">
                <label class="form-check-label" for="female">Female</label>
            </div>
        </div>
        <div class="form-group">
            <label for="c_dob">Date of Birth:</label>
            <input type="date" class="form-control" id="dob" name="dob">
        </div>
        <div class="form-group">
            <label for="c_shift">Shifts:</label>
            <input type="checkbox" id="shift1" name="shift" value="M"> Morning
            <input type="checkbox" id="shift2" name="shift" value="A"> Afternoon
        </div>
        <div class="form-group">
            <label for="c_depart">Department:</label>
            <br>
            <select for="c_depart" id="c_depart">
                <option value="1">CEO</option>
                <option value="2">Testing</option>
                <option value="3">R&D</option>
                
            </select>
            @* <input type="text" class="form-control" id="depart" name="depart"> *@
        </div>
        <div class="form-group">
            <label for="imgFile">Image:</label>
            <input type="file" class="form-control" id="imgFile" name="imgFile">
        </div>
        <br />
        <button type="button" class="btn btn-primary" id="AddEmployeeButton">Add Employee</button>
    </form>
</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"
    integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
@section Scripts
{
    <script>
        $(document).ready(function () {
            $("#AddEmployeeButton").click(function () {
                @* var selectedShifts = [];
                $("input[name='shift']:checked").each(function () {
                    selectedShifts.push($(this).val());
                });
                var uploadfile=$('#imgFile').get(0);
                var files=uploadfile.files;
                var emp = {
                    c_empname: $("#empname").val(),
                    c_gender: $("input[name='empgender']:checked").val(),
                    c_dob: $("#dob").val(),
                    c_shift: selectedShifts.join(","),
                    c_depart: $("#depart").val(),
                    c_img: files[0]
                }; *@

                var formData = new FormData();
                var photoFile = $('#imgFile')[0].files[0];
                formData.append("imgFile", photoFile);
                formData.append("c_empname", $('#empname').val());
                formData.append("c_dob", $('#dob').val());
                formData.append("c_empgender", $('input[name="empgender"]:checked').val());
                formData.append("c_depart", $('#c_depart').val());
                formData.append("c_img", "a");
                formData.append("c_shift", $('input[name="shift"]:checked').map(function () { return $(this).val(); }).get().join());
                

                $.ajax({
                    url: 'https://localhost:7022/api/SimpleAPI/AddEmployee',
                    type: 'POST',
                    data: formData,
                    processData: false,
                    contentType: false,

                    success: function (data) {
                        if(data){
                            alert("Employee added successfully!");
                            debugger
                            window.location="./Index";
                        }
                        else{
                            alert("Some error Occured!");
                        }
                        
                    },
                    error: function (xhr, status, error) {
                        alert("Error adding employee: " + error);
                    }
                });
            });
        });
    </script>
}